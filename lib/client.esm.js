import e from"url-join";var n=/*#__PURE__*/function(){function n(n,t){this.eventSource=void 0,this._callbacks=void 0,this.onOpenBound=void 0,this.onErrorBound=void 0,this.closeBound=void 0;var o=t?e(n,t):n;this.eventSource=new EventSource(o),this.onOpenBound=this.onOpen.bind(this),this.onErrorBound=this.onError.bind(this),this.closeBound=this.close.bind(this),this.eventSource.addEventListener("open",this.onOpenBound),this.eventSource.addEventListener("error",this.onErrorBound),this.eventSource.addEventListener("close",this.closeBound),this._callbacks={}}var t=n.prototype;return t.onOpen=function(e){},t.onError=function(e){},t.close=function(){this.eventSource&&(this.eventSource.removeEventListener("open",this.onOpenBound),this.eventSource.removeEventListener("error",this.onErrorBound),this.eventSource.removeEventListener("close",this.closeBound),this.removeAllEventListener(),this.eventSource.close(),this.eventSource=null)},t.addEventListener=function(e,n){var t,o=this,r=function(t){var o=JSON.parse(t.data);n({type:e,data:o})};return this.removeEventListener(e),this._callbacks[e]=r,null==(t=this.eventSource)||t.addEventListener(e,r),function(){return o.removeEventListener(e)}},t.removeEventListener=function(e){var n,t=this._callbacks[e];t&&(null==(n=this.eventSource)||n.removeEventListener(e,t),delete this._callbacks[e])},t.removeAllEventListener=function(){var e=this;Object.keys(this._callbacks).forEach(function(n){return e.removeEventListener(n)})},n}();export{n as Client};
//# sourceMappingURL=client.esm.js.map
