{"version":3,"file":"client.umd.js","sources":["../node_modules/url-join/lib/url-join.js","../client/index.js"],"sourcesContent":["(function (name, context, definition) {\n  if (typeof module !== 'undefined' && module.exports) module.exports = definition();\n  else if (typeof define === 'function' && define.amd) define(definition);\n  else context[name] = definition();\n})('urljoin', this, function () {\n\n  function normalize (strArray) {\n    var resultArray = [];\n    if (strArray.length === 0) { return ''; }\n\n    if (typeof strArray[0] !== 'string') {\n      throw new TypeError('Url must be a string. Received ' + strArray[0]);\n    }\n\n    // If the first part is a plain protocol, we combine it with the next part.\n    if (strArray[0].match(/^[^/:]+:\\/*$/) && strArray.length > 1) {\n      var first = strArray.shift();\n      strArray[0] = first + strArray[0];\n    }\n\n    // There must be two or three slashes in the file protocol, two slashes in anything else.\n    if (strArray[0].match(/^file:\\/\\/\\//)) {\n      strArray[0] = strArray[0].replace(/^([^/:]+):\\/*/, '$1:///');\n    } else {\n      strArray[0] = strArray[0].replace(/^([^/:]+):\\/*/, '$1://');\n    }\n\n    for (var i = 0; i < strArray.length; i++) {\n      var component = strArray[i];\n\n      if (typeof component !== 'string') {\n        throw new TypeError('Url must be a string. Received ' + component);\n      }\n\n      if (component === '') { continue; }\n\n      if (i > 0) {\n        // Removing the starting slashes for each component but the first.\n        component = component.replace(/^[\\/]+/, '');\n      }\n      if (i < strArray.length - 1) {\n        // Removing the ending slashes for each component but the last.\n        component = component.replace(/[\\/]+$/, '');\n      } else {\n        // For the last component we will combine multiple slashes to a single one.\n        component = component.replace(/[\\/]+$/, '/');\n      }\n\n      resultArray.push(component);\n\n    }\n\n    var str = resultArray.join('/');\n    // Each input component is now separated by a single slash except the possible first plain protocol part.\n\n    // remove trailing slash before parameters or hash\n    str = str.replace(/\\/(\\?|&|#[^!])/g, '$1');\n\n    // replace ? in parameters with &\n    var parts = str.split('?');\n    str = parts.shift() + (parts.length > 0 ? '?': '') + parts.join('&');\n\n    return str;\n  }\n\n  return function () {\n    var input;\n\n    if (typeof arguments[0] === 'object') {\n      input = arguments[0];\n    } else {\n      input = [].slice.call(arguments);\n    }\n\n    return normalize(input);\n  };\n\n});\n","import urljoin from 'url-join'\n\nclass Client {\n  constructor(path, channel) {\n    const fullPath = urljoin(path, channel)\n\n    this.eventSource = new EventSource(fullPath)\n    this.channel = channel\n\n    // open and error are reserved\n    this.eventSource.addEventListener('open', this.onOpen.bind(this))\n    this.eventSource.addEventListener('error', this.onError.bind(this))\n\n    // close is a standard message, hijacked for our purposes\n    this.eventSource.addEventListener('close', this.close.bind(this))\n  }\n\n  onOpen(event) {}\n\n  onError(event) {}\n\n  close(event) {\n    this.eventSource.close()\n    this.eventSource = null\n  }\n\n  addEventListener(eventName, _callback) {\n    const callback = (event) => {\n      const type = event.type\n      const data = JSON.parse(event.data)\n\n      _callback({\n        type,\n        data,\n      })\n    }\n\n    this.eventSource.addEventListener(eventName, callback)\n  }\n}\n\nexport default Client\n"],"names":["name","context","definition","module","exports","this","normalize","strArray","resultArray","length","TypeError","match","first","shift","replace","i","component","push","str","join","parts","split","input","arguments","slice","call","Client","constructor","path","channel","fullPath","urljoin","eventSource","EventSource","addEventListener","onOpen","bind","onError","close","event","eventName","_callback","callback","type","data","JSON","parse"],"mappings":"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"}